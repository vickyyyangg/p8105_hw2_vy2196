---
title: "p8105_hw2_vy2196"
output: github_document
---

### Problem 1

```{r}
library(tidyverse)
library(readxl)
```


```{r message=FALSE, warning=FALSE}

pols_month_df = read_csv(file = "data/pols-month.csv") |>
    # break up the variable 
    separate(mon, into = c("year", "month", "day"), sep = "-") |>
  # replace month number with month name
  mutate(
    year = as.integer(year),
    month = factor(month.name[as.integer(month)],
                   levels = month.name, ordered = TRUE),
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem == 1 ~ "dem")) |>
  select(-prez_gop, -prez_dem, -day)
pols_month_df
```

```{r}
snp_df = read_csv(file = "data/snp.csv") |>
  janitor::clean_names() |>
  separate(date, into = c("month", "day", "year"), 
           sep = "/", convert = TRUE) |>
  mutate(
    year = ifelse(year < 50, 2000 + year,
                     ifelse(year < 100, 1900 + year, year)),
    year = as.integer(year)) |>
  mutate(month = factor(month(month, label = TRUE, abbr = FALSE),
                   levels = month.name, ordered = TRUE)) |>
  arrange(year, month) |>
  select(year, month, everything(), -day)

snp_df
```

```{r}
unemployment_df = read_csv(file = "data/unemployment.csv") |>
  # switch from wide to long
    pivot_longer(
      cols = Jan:Dec,
      names_to = "month",
      values_to = "unemployment") |>
  # Rename Year to year
  rename(year = Year) |>
  # Convert abbreviations to full month names
  mutate(
    year = as.integer(year),
    month = recode(month,
                   "Jan" = "January",
                   "Feb" = "February",
                   "Mar" = "March",
                   "Apr" = "April",
                   "May" = "May",
                   "Jun" = "June",
                   "Jul" = "July",
                   "Aug" = "August",
                   "Sep" = "September",
                   "Oct" = "October",
                   "Nov" = "November",
                   "Dec" = "December"),
    month = factor(month, levels = month.name, ordered = TRUE)) |>
  arrange(year, month) |>
  select(year, month, unemployment)
  
unemployment_df
```

```{r}
merged_data = 
  left_join(pols_month_df, snp_df, by = c("year", "month")) |> 
  left_join(x = _, y = unemployment_df, by = c("year", "month")) 
names(merged_data)
glimpse(merged_data)

merged_data

```

```{r}
# checking the range of year for each df
range(pols_month_df$year)
range(snp_df$year)
range(unemployment_df$year)

```

#### Decription of cleaned dataset
The dimension of `pols_month_df` is 882 x 9, and the year range is from 1947 - 2015. I separated the date and only kept `year` and `month`. I also added a single column of `president` where its value is either `dem` or `gop`. 

The dimension of `snp_df` is 787 x 3, and the year range is from 1950 - 2015. I also separated the date and only kept `year` and `month`. I also turned the year from 2 digits to 4 digits to match the rest of the data.

The dimension of `unemployment_df` is 816 x 3 and the year range is from 1948 - 2015. I converted the format from wide to long, and renamed the variables of the month to match the rest of the data set. 


## Problem 2


```{r}
# Import and clean Mr. Trash Wheel
mr_trash = read_excel ("data/trash_wheel.xlsx", 
                       sheet = "Mr. Trash Wheel", range = "A2:N709") |>
  #Removes rows where the Dumpster column is blank
  filter(!is.na(Dumpster)) |>
  #Converts messy column names
  janitor::clean_names() |>
  mutate(
    #rounds sports ball counts to the nearest whole number
    sports_balls = as.integer(round(sports_balls)),
    trash_wheel = "Mr. Trash Wheel")

mr_trash
```


```{r}
# Import and clean Professor Trash Wheel
pro_trash_wheel = read_excel ("data/trash_wheel.xlsx", 
                       sheet = "Professor Trash Wheel", range = "A2:M134") |>
  #Removes rows where the Dumpster column is blank
  filter(!is.na(Dumpster)) |>
  #Converts messy column names
  janitor::clean_names() |>
  mutate(trash_wheel = "Professor Trash Wheel")

pro_trash_wheel
```




